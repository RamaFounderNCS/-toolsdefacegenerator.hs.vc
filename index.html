<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Deface Generator ULTIMATE</title>
  <style>
    :root {
      --main-color: #00ff9f;
      --bg-color: #000;
      --text-color: #0f0;
    }

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Courier New', monospace;
      background-color: var(--bg-color);
      color: var(--text-color);
      padding: 2rem 1rem;
    }

    h1 {
      text-align: center;
      font-size: 2.5rem;
      text-shadow: 0 0 10px var(--main-color);
      margin-bottom: 1.5rem;
    }

    form {
      background: #111;
      padding: 1.5rem;
      border-radius: 10px;
      max-width: 700px;
      margin: auto;
      box-shadow: 0 0 10px #0f0;
    }

    label {
      display: block;
      margin-top: 1rem;
    }

    input, textarea, select {
      width: 100%;
      padding: 0.6rem;
      background: #000;
      color: #0f0;
      border: 1px solid #0f0;
      border-radius: 5px;
      font-family: monospace;
      font-size: 0.95rem;
    }

    button {
      width: 100%;
      margin-top: 1.5rem;
      background: var(--main-color);
      color: #000;
      padding: 0.8rem;
      border: none;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
      font-size: 1rem;
      transition: 0.3s;
    }

    button:hover {
      opacity: 0.9;
    }

    .output {
      max-width: 800px;
      margin: 2rem auto;
    }

    .output textarea {
      width: 100%;
      height: 300px;
      background: #111;
      color: #0f0;
      border: 1px solid #0f0;
      padding: 1rem;
      border-radius: 8px;
      font-size: 0.9rem;
    }

    .preview {
      margin-top: 2rem;
      border: 2px solid #0f0;
      border-radius: 10px;
      overflow: hidden;
    }

    iframe {
      width: 100%;
      height: 400px;
      border: none;
      background: black;
    }

    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }

    .btn-group button {
      flex: 1;
      min-width: 48%;
    }

    @media (max-width: 600px) {
      h1 {
        font-size: 2rem;
      }

      iframe {
        height: 300px;
      }
    }
  </style>
</head>
<body>
  <h1>üî• DEFACE GENERATOR ULTIMATE üî•</h1>
  <form id="defaceForm">
    <!-- Form inputs as before -->
    <!-- ... shortened for brevity ... -->
  </form>

  <div class="output">
    <label>Script Deface Output:</label>
    <textarea id="outputScript" readonly></textarea>
    <div class="preview" id="previewSection">
      <label style="display: block; margin: 1rem 0; text-align: center;">üîç Live Preview:</label>
      <iframe id="previewFrame"></iframe>
    </div>
  </div>

  <script>
    const form = document.getElementById('defaceForm');
    const outputBox = document.getElementById('outputScript');
    const previewFrame = document.getElementById('previewFrame');
    let lastGeneratedHTML = '';

    document.querySelectorAll("input, textarea, select").forEach(input => {
      input.addEventListener("input", () => {
        const formData = {};
        document.querySelectorAll("input, textarea, select").forEach(el => {
          formData[el.id] = el.value;
        });
        localStorage.setItem("defaceFormData", JSON.stringify(formData));
      });
    });

    function restoreFormData() {
      const saved = localStorage.getItem("defaceFormData");
      if (!saved) return;
      const data = JSON.parse(saved);
      for (let key in data) {
        const el = document.getElementById(key);
        if (el) el.value = data[key];
      }
    }

    form.addEventListener('submit', function(e) {
      e.preventDefault();

      const style = signatureStyle.value.trim();
      const name = titleName.value.trim();
      const message = message.value.trim().replace(/\n/g, "<br>");
      const textColor = textColor.value;
      const bgImage = bgPreset.value || bgImage.value.trim();
      const music = music.value.trim();
      const footer = footerText.value.trim();
      const anim = titleEffect.value;
      const font = fontStyle.value;

      let animStyle = '';
      let animTag = `<h1>${style} ${name}</h1>`;
      if (anim === 'type') {
        animStyle = `@keyframes typing {from{width:0} to{width:100%}} h1{overflow:hidden; white-space:nowrap; width:0; animation: typing 4s steps(30, end) forwards;}`;
      } else if (anim === 'blink') {
        animStyle = `h1 {animation: blink 1s step-start infinite;} @keyframes blink { 50% { opacity: 0; } }`;
      } else if (anim === 'zoom') {
        animStyle = `h1 { animation: zoomIn 2s ease; } @keyframes zoomIn { 0% { transform: scale(0); } 100% { transform: scale(1); } }`;
      }

      const html = `<!DOCTYPE html><html><head><meta charset='UTF-8'><meta name='viewport' content='width=device-width, initial-scale=1.0'><title>${style} ${name}</title>
<style>body {background: black url('${bgImage}') center/cover no-repeat; color: ${textColor}; text-align: center; font-family: '${font}', monospace; padding-top: 20vh;} ${animStyle} p { font-size: 1.5rem; } footer { margin-top: 3rem; color: #999; font-size: 0.9rem; }</style></head>
<body>${animTag}<p>${message}</p>${music ? `<audio src="${music}" autoplay loop></audio>` : ''}<footer>${footer}</footer></body></html>`;

      outputBox.value = html;
      lastGeneratedHTML = html;

      const blob = new Blob([html], { type: "text/html" });
      const url = URL.createObjectURL(blob);
      previewFrame.src = url;
      setTimeout(() => previewSection.scrollIntoView({ behavior: 'smooth' }), 300);
    });

    function downloadScript() {
      if (!lastGeneratedHTML) return alert('Silakan generate dulu.');
      const blob = new Blob([lastGeneratedHTML], { type: "text/html" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = "deface_script.html";
      a.rel = "noopener";
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
    }

    restoreFormData();
  </script>
</body>
</html>
